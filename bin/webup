#!/usr/bin/env python

"""
Usage:
    webup serve
"""

import sys

import docopt

import vanilla


def main(argv):
    if argv['serve']:
        h = vanilla.Hub()

        b = h.bean(host='0.0.0.0', port=8080)

        b.static('/', 'serve/index.html')
        b.static('/css', 'serve/css')
        b.static('/js', 'serve/js')
        b.static('/build', 'serve/build')

        @b.websocket('/')
        def echo(ws):
            while True:
                ws.send(ws.recv())

        h.stop_on_term()


if __name__ == '__main__':
    argv = docopt.docopt(__doc__)
    sys.exit(main(argv))
